<!DOCTYPE html>
<html class="no-js" lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>GC Simple Dictionary - Fast and lightweight autocomplete dictionary</title>
    <meta content="width=device-width,initial-scale=1" name="viewport" />
    <meta
      name="description"
      content="Fast and lightweight autocomplete dictionary"
    />
    <!-- Meta data-->
    <!-- Load closure template scripts -->
    <script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/rn/cdts/compiled/soyutils.js"></script>
    <script src="https://www.canada.ca/etc/designs/canada/cdts/gcweb/rn/cdts/compiled/wet-en.js"></script>
    <script src="./autocomplete.js"></script>
    <script src="./data.js"></script>
    <link rel="stylesheet" type="text/css" href="./autocomplete.css" />
    <noscript>
      <!-- Write closure fall-back static file -->
      <!-- /ROOT/app/cls/WET/gcweb/v4_0_28/cdts/static/refTop.html -->
    </noscript>
    <!-- Write closure template -->
    <script>
      document.write(
        wet.builder.refTop({
          isApplication: true,
        })
      );
    </script>

    <style>
      ::-webkit-input-placeholder {
        color: #888;
      }
      :-moz-placeholder {
        color: #888;
      }
      ::-moz-placeholder {
        color: #888;
      }
      :-ms-input-placeholder {
        color: #888;
      }

      input[type="text"] {
        display: block;
        float: left;
        width: 100%;
        box-sizing: border-box;
        font: 13px/20px "Lucida Sans Unicode", sans-serif;
        color: black;
        padding: 5px 9px 4px 9px;
        outline: none;
        border: 1px solid #2da5da;
        position: relative;
        border-radius: 4px;
        -webkit-appearance: none;
      }

      input[type="text"]:focus {
        border-color: #2da5da;
      }

      .autocomplete {
        border-color: #2da5da;
        border-radius: 4px;
      }

      .autocomplete > div {
        padding: 0 9px;
        font-size: 12px;
        line-height: 21px;
        padding-bottom: 2px;
      }

      .box {
        width: 190px;
        box-sizing: border-box;
        border: 1px solid rgba(255, 255, 255, 0.8);
        border-radius: 4px;
        float: left;
        margin: 0;
        padding: 0;
        background: white;
        text-align: center;
        display: table;
        font-size: 17px;
        line-height: 26px;
        box-shadow: rgba(0, 0, 0, 0.3) 0 0 2px;
      }

      .box > div {
        display: table-cell;
        vertical-align: middle;
        font-size: 14px;
      }

      @media (max-width: 600px) {
        .box {
          color: white;
          background: none;
          border: none;
          text-align: left;
          box-shadow: none;
        }
        .box > div {
          line-height: 14px;
        }
      }

      .text-shadow {
        text-shadow: 0 1px 1px rgba(0, 0, 0, 0.4);
      }

      .box + .box {
        margin-left: 15px;
      }

      @media (max-width: 600px) {
        .box {
          width: 100%;
        }
        .box + .box {
          margin-top: 20px;
          margin-left: 0;
        }
      }

      .boxes {
        margin-top: 20px;
      }

      .boxes:after {
        content: "";
        display: table;
        clear: both;
      }

      .boxes + .boxes {
        margin-top: 18px;
      }

      .headline {
        width: 100%;
        margin: 60px 0 0 0;
        padding: 0;
        color: white;
        font: 18px/30px "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        border-bottom: 1px dotted white;
      }

      .headline.links {
        margin-top: 30px;
      }

      #result {
        background-color: white;
        margin-top: 3em;
        margin-bottom: 2em;
        padding: 0.25em;
      }

      .link {
        color: white;
        text-decoration: none;
        font: 15px/30px "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
      }

      .link:hover {
        text-decoration: underline;
      }

      .link + .link {
        margin-left: 15px;
      }

      strong {
        font-weight: bold !important;
      }

      @media (max-width: 600px) {
        .headline + .link {
          margin-top: 10px;
        }

        .link {
          width: 100%;
          display: block;
          font-size: 14px;
        }

        .link + .link {
          margin-left: 0;
        }
      }
    </style>
  </head>
  <body vocab="https://schema.org/" typeof="WebPage">
    <div id="def-top">
      <!-- Write closure fall-back static file -->
      <!-- /ROOT/app/cls/WET/gcweb/v4_0_28/cdts/static/appTop-en.html -->
    </div>
    <!-- Write closure template -->
    <script>
      var defTop = document.getElementById("def-top");
      defTop.outerHTML = wet.builder.appTop({
        appName: [{ text: "Simple Dictionary - Dictionnaire simplifié", href: "#" }],
      });
    </script>
    <main role="main" property="mainContentOfPage" class="container">
      <h3>Lookup - Recherche</h3>
      <input type="text" id="userinput" placeholder="Start typing - Commencez à taper" />
      <div id="result"></div>

      <h4>Other dictionaries / Autres dictionnaires:</h4>
      <ul>
        <li><a href="https://www.btb.termiumplus.gc.ca/tpv2alpha/alpha-eng.html?lang=eng">TERMIUM® is the Government of Canada's terminology and linguistic data bank</a></li>
        <li><a href="https://www.tbs-sct.gc.ca/pol/glossary-lexique-eng.aspx">Treasury Board of Canada Secretariat - Glossary</a></li>
      </ul>

      <div id="def-preFooter">
        <!-- Write closure fall-back static file -->
        <!-- /ROOT/app/cls/WET/gcweb/v4_0_28/cdts/static/preFooter-en.html -->
      </div>
   

    </main>
    <div id="def-footer">
      <!-- Write closure fall-back static file -->
      <!-- /ROOT/app/cls/WET/gcweb/v4_0_28/cdts/static/appFooter-en.html -->
    </div>
    <!-- Write closure template -->
    <script>
      var defFooter = document.getElementById("def-footer");
      defFooter.outerHTML = wet.builder.appFooter({
        footerSections: [
          {
            href: "https://github.com/wmoussa-gc/gc-simple-dictionary/edit/main/data.js",
            text: "Add/Update a new definition - Ajouter/mettre à jour une nouvelle définition",
          },
          {
            href: "https://github.com/wmoussa-gc/gc-simple-dictionary",
            text: "Improve the web page - Améliorer la page web",
          },
        ],
        showFeatures: false,
      });
    </script>
    <!-- Write closure template -->
    <script>
      document.write(
        wet.builder.refFooter({
          isApplication: true,
        })
      );
    </script>

    <script>
      var allowedChars = new RegExp(/^[a-zA-Z\s]+$/);

      function charsAllowed(value) {
        return allowedChars.test(value);
      }


      autocomplete({
        input: document.getElementById("userinput"),
        minLength: 1,
        onSelect: function (item, inputfield) {
          inputfield.value = item.label;
          _explanation = item.explanation ? item.explanation : "";
          _link = item.link ? `<a href=${item.link}>${item.link}</a>` : "";

          _label_fr = item.label_fr ? "<strong>"+item.label_fr+"</strong>" : "<i>La version française est manquante</i>"
          _value_fr = item.value_fr ? `: ${item.value_fr}` : "";
          _explanation_fr = item.explanation_fr ? item.explanation_fr : "";
          _link_fr = item.link_fr ? `<a href=${item.link_fr}>${item.link_fr}</a>` : "";

          const value = item.value !== undefined ? `: ${item.value}` : "";
          document.getElementById(
            "result"
          ).innerHTML = `<strong>${item.label}</strong>${value}<p>${_explanation}</p><p>${_link}</p><p>Link to this definition: <a href="${window.location.href.split('?')[0]}?q=${item.label}">${window.location.href.split('?')[0]}?q=${item.label}</a>
            <hr/>${_label_fr}${_value_fr}<p>${_explanation_fr}</p><p>${_link_fr}</p>`;
        },
        fetch: function (text, callback) {
          var match = text.toLowerCase();
          callback(data.filter(function(n){
            if(n.label_fr) {
              return n.label.toLowerCase().startsWith(match) || n.label_fr.toLowerCase().startsWith(match);
            } else {
              return n.label.toLowerCase().startsWith(match);
            }
          }));
        },
        render: function (item, value) {
          var itemElement = document.createElement("div");
          if (charsAllowed(value)) {
            var regex = new RegExp(value, "gi");
            var inner = item.label.replace(regex, function (match) {
              return "<strong>" + match + "</strong>";
            });
            if(item.label_fr){
              var inner_fr = item.label_fr.replace(regex, function (match) {
                return "<strong>" + match + "</strong>";
              });
              itemElement.innerHTML = inner + " " + (item.value || "") + " - " + inner_fr + " " + (item.value_fr || "") ;
            } else {
              itemElement.innerHTML = inner + " " + (item.value || "");
            }
          } else {
            itemElement.textContent = item.label + (item.value || "");
          }
          return itemElement;
        },
        emptyMsg: "No word found - Aucun mot trouvé",
        customize: function (input, inputRect, container, maxHeight) {
          if (maxHeight < 100) {
            container.style.top = "";
            container.style.bottom = window.innerHeight - inputRect.bottom + input.offsetHeight + "px";
            container.style.maxHeight = "140px";
          }
        },
      });

      const urlParams = new URLSearchParams(window.location.search);
      const myParam = urlParams.get('q');

      if(myParam) {
        var s = document.getElementById("userinput");
        s.value = myParam;
        results = data.filter((n) => n.label.toLowerCase() == myParam.toLowerCase());
        if(results.length == 1){
          item = results[0];
          _explanation = item.explanation ? item.explanation : "";
          _link = item.link ? `<a href=${item.link}>${item.link}</a>` : "";

          const value = item.value !== undefined ? `: ${item.value}` : "";
          document.getElementById(
            "result"
          ).innerHTML = `<strong>${item.label}</strong>${value}<p>${_explanation}</p><p>${_link}</p><p>Link to this definition: <a href="${window.location}">${window.location}</a>`;
        }
      }

      document.querySelector("input").focus();

      function filterLabels(item, match) {
        item.label.toLowerCase().startsWith(match);
      }
    </script>
  </body>
</html>
